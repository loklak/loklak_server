buildscript {
  repositories {
    jcenter()
  }

  dependencies {
    classpath 'com.github.jengelman.gradle.plugins:shadow:1.2.4'
  }
}

apply plugin: 'java'
apply plugin: 'com.github.johnrengelman.shadow'

sourceCompatibility = 1.8
targetCompatibility = 1.8

sourceSets.main.java.srcDirs = ['src']
sourceSets.main.resources.srcDirs = ['res']

jar {
  manifest {
    attributes 'Main-Class': 'org.loklak.LoklakServer'
  }
}

shadowJar {
  mergeServiceFiles()
}

repositories {
  flatDir {
    dirs 'lib'
  }
}

dependencies {
  compile name: 'antlr-runtime-3.5'
  compile name: 'asm-4.1'
  compile name: 'asm-commons-4.1'
  compile name: 'bcprov-jdk15on-154'
  compile name: 'bcpkix-jdk15on-154'
  compile name: 'boilerpipe-1.2-dev'
  compile name: 'commons-cli-1.3.1'
  compile name: 'commons-logging-1.2'
  compile name: 'compiler-0.8.13'
  compile name: 'compress-lzf-1.0.2'
  compile name: 'elasticsearch-2.4.0'
  compile name: 'groovy-all-2.4.4-indy'
  compile name: 'guava-18.0'
  compile name: 'hamcrest-core-1.3'
  compile name: 'HdrHistogram-2.1.6'
  compile name: 'hppc-0.7.1'
  compile name: 'httpclient-4.5.2'
  compile name: 'httpcore-4.4.4'
  compile name: 'httpmime-4.5.2'
  compile name: 'jackson-core-2.8.1'
  compile name: 'jackson-dataformat-cbor-2.8.1'
  compile name: 'jackson-dataformat-smile-2.8.1'
  compile name: 'jackson-dataformat-yaml-2.8.1'
  compile name: 'javax.mail-1.5.5'
  compile name: 'javax.servlet-api-3.1.0'
  compile name: 'jcommon-1.0.18'
  compile name: 'jdom-1.1.3'
  compile name: 'jetty-http-9.3.11.v20160721'
  compile name: 'jetty-io-9.3.11.v20160721'
  compile name: 'jetty-rewrite-9.3.11.v20160721'
  compile name: 'jetty-security-9.3.11.v20160721'
  compile name: 'jetty-server-9.3.11.v20160721'
  compile name: 'jetty-servlet-9.3.11.v20160721'
  compile name: 'jetty-servlets-9.3.11.v20160721'
  compile name: 'jetty-util-9.3.11.v20160721'
  compile name: 'jetty-webapp-9.3.11.v20160721'
  compile name: 'jfreechart-1.0.19'
  compile name: 'jna-4.1.0'
  compile name: 'joda-convert-1.2'
  compile name: 'joda-time-2.9.4'
  compile name: 'json-schema-validator-2.2.6-lib'
  compile name: 'jsoup-1.9.2'
  compile name: 'jsr166e-1.1.0'
  compile name: 'jts-1.13'
  compile name: 'junit-4.12'
  compile name: 'log4j-1.2-api-2.6.2'
  compile name: 'log4j-api-2.6.2'
  compile name: 'log4j-core-2.6.2'
  compile name: 'log4j-slf4j-impl-2.6.2'
  compile name: 'lucene-analyzers-common-5.5.2'
  compile name: 'lucene-backward-codecs-5.5.2'
  compile name: 'lucene-core-5.5.2'
  compile name: 'lucene-grouping-5.5.2'
  compile name: 'lucene-highlighter-5.5.2'
  compile name: 'lucene-join-5.5.2'
  compile name: 'lucene-memory-5.5.2'
  compile name: 'lucene-misc-5.5.2'
  compile name: 'lucene-queries-5.5.2'
  compile name: 'lucene-queryparser-5.5.2'
  compile name: 'lucene-sandbox-5.5.2'
  compile name: 'lucene-spatial-5.5.2'
  compile name: 'lucene-spatial3d-5.5.2'
  compile name: 'lucene-suggest-5.5.2'
  compile name: 'nekohtml-1.9.17'
  compile name: 'netty-3.10.6.Final'
  compile name: 'rome-1.0'
  compile name: 'securesm-1.0'
  compile name: 'slf4j-api-1.7.21'
  compile name: 'snakeyaml-1.15'
  compile name: 'spatial4j-0.5'
  compile name: 't-digest-3.0'
  compile name: 'twitter4j-core-4.0.2'
  compile name: 'twitter4j-stream-4.0.2'
  compile name: 'xerces-2.9.1'
}

task setup(type: JavaExec, dependsOn: classes) {
  main = 'org.loklak.LoklakInstallation'
  classpath sourceSets.main.runtimeClasspath
  classpath configurations.runtime
}

task start(type: JavaExec, dependsOn: classes) {
  main = 'org.loklak.LoklakServer'
  classpath sourceSets.main.runtimeClasspath
  classpath configurations.runtime
}